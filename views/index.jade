!!!
html(lang="en")
    head
        meta(charset="utf-8")
        meta(name="viewport", content="width=device-width, initial-scale=1.0")
        meta(name="keywords", content="captcha, recaptcha, ocr, optical character recognition, ocular character recognition")
        meta(name="description", content="Webpages for Humans: surf the human web")
        meta(name="author", content="Jesse Fulton")
        title Web Biennial 2012 - Jesse Fulton - Webpages for Humans
        link(rel='stylesheet', href='/bootstrap-ui/css/bootstrap.css')
        style(type="text/css")
            .thumbnails .meta { text-align: center; }
            .thumbnails .icon { padding-right: 4px; }
            .thumbnail-nav { display:inline-block; width: 80px; }
            .thumbnail-nav { display:inline-block; width: 80px; }
            .row { margin-top: 5px; margin-bottom: 15px; }
            .hero-unit h1
            , .hero-unit .form-inline
            , .hero-unit #bookmarklet { text-align: right; padding-right: 80px; }
            .hero-unit .form-inline { margin-top: 20px; }
            #bookmarklet { font-style: italic; text-align: right; margin-top: 20px; }
            .hero-unit { padding-bottom: 20px; }
            #bookmarklet a { font-style: normal; }
            #header { height:10%; width: 100%; margin:0; padding: 0; overflow:hidden; }
            #content { width: 100%; height:90%; margin:0; padding:0; }
            
            body {
                border: 1px solid black;
            }
            #browser {
                border: 1px solid white;
                background-color: #d7d7d7;
                outline: 2px solid black;
                padding: 1px 4px;
            }
            #title-bar {
                height: 18px;
                width: 100%;
                background: transparent url('stylesheets/images/header-bg.png') repeat-x right top;
            }
            #title-bar span {
                display:block;
                height: 18px;
                width: 157px;
                background: transparent url('stylesheets/images/title.png') no-repeat center top;
                margin: 0 auto;
                text-indent: -5000px;
            }
            
            #toolbar { 
                background-color: #e5e5e5;
                outline: 1px solid black;
                border: 1px solid white;
            }
            
            #nav .btn {
                width: 32px;
                height: 32px;
                background-image: url('stylesheets/images/back-forward-home.png');
                text-indent: -5000px;
                border: none;
            }
            #nav .btn a { display: block; width: 100%; height: 100%; }
            #nav-back:hover { background-position: 0 0; }
            #nav-forward, #nav-forward:hover { background-position: -46px 0; }
            #nav-home, #nav-home:hover { background-position: -94px 0; }
            
            #content {
                outline: 1px solid black;
                border: 1px solid white;
            }
            
            #location {
                padding-top: 72px;
                background: transparent url('stylesheets/images/location.png') no-repeat left top;
            }

        script(type="text/javascript", src="/bootstrap-ui/js/jquery.js")
        script(type="text/javascript", src="/js-hash/Hash.js")
        script(type="text/javascript", src="/js-hash/jquery.hash.js")
        script(type="text/javascript")

          var iframeChanged = function(where) { onHashChange(null, where.href, true); }

          //$('#bookmarklet a').tooltip({})
          //$('#captcha-image').modal({"show":false})
          var doGenerate = function() {
              var url = document.getElementById("generateUrl").value;
              //window.location = "/view/" + url;
              $.hash.go("/view/" + url);
              return false;
              //return goTo("/view/" + url);
          }
          var goTo = function(url) {
            if (url) {
              
              var iDoc = document.getElementById("viewport").contentWindow || document.getElementById("viewport").contentDocument;
              iDoc.location.replace(url);
            }
              //.attr("src", url);
              //$.hash.go(url);
              return false;
          }

          var onHashChange = function(event, newHash, bypass) {
            console.log(arguments);
            document.getElementById("generateUrl").value = newHash.replace(/^\/view\//g, "");
            if (!bypass) goTo(newHash);
          };

    body
        #browser
            #title-bar: span Webpages For Humans
            #toolbar
                #nav
                    #nav-back.btn Back
                    #nav-forward.btn Forward
                    #nav-home.btn: a(href="/about", id="aboutButton") Home
                #location
                    input(type="text", name="generateUrl", id="generateUrl")
                    button.btn.btn-primary.btn-large(id="doGenerate", href="#") Go!
                    
            
            //-
                #header.container
                    p.form-inline Surf the human web. Enter a URL to begin: 
                        input(type="text", name="generateUrl", id="generateUrl")
                        button.btn.btn-primary.btn-large(id="doGenerate", href="#") Go!
                        a(href="/about", id="aboutButton") About?
    
            #content.container
                iframe(id="viewport", src="/about", style="width:100%;height:90%", frameBorder="0", onLoad="iframeChanged(this.contentWindow.location);")
    
            script(type="text/javascript")
    
              $("body").hashchange(onHashChange);
              $.hash.init();
    
              $("#doGenerate").on('click', doGenerate);
              $("#aboutButton").on('click', function(){ $.hash.go("/about"); return false; });
    
              $("#generateUrl").on('keypress', function(event) {
                  if (event.which == 13) {
                      $("#doGenerate").click();
                      //doGenerate();
                  }
              });
    
