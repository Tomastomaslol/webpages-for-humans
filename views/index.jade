!!!
html(lang="en")
    head
        meta(charset="utf-8")
        meta(name="viewport", content="width=device-width, initial-scale=1.0")
        meta(name="keywords", content="captcha, recaptcha, ocr, optical character recognition, ocular character recognition")
        meta(name="description", content="Webpages for Humans: surf the human web")
        meta(name="author", content="Jesse Fulton")
        title Web Biennial 2012 - Jesse Fulton - Webpages for Humans
        style(type="text/css")
            html, body { background-color: black; }
            body, #console{
                background:#000000;
                color:#00FF00;
                font-family:monospace;
            }
            
            #console { padding-left:40px; }
            
            #desktop, #browser { display:none; }


        script(type="text/javascript", src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js")
        script(type="text/javascript", src="/typer.js")
        script(type="text/javascript")
            Typer.speed=3;
            Typer.file='kernel.txt';
            Typer.init();
            
            
        link(rel='stylesheet', href='/bootstrap-ui/css/bootstrap.css')
        link(rel='stylesheet', href='/stylesheets/main.css')

        script(type="text/javascript", src="/bootstrap-ui/js/jquery.js")
        script(type="text/javascript", src="/js-hash/Hash.js")
        script(type="text/javascript", src="/js-hash/jquery.hash.js")
        script(type="text/javascript")

            var iframeChanged = function(where) { onHashChange(null, where.href, true); }
            
            var doGenerate = function() {
                var url = document.getElementById("browserUrl").value;
                $.hash.go("/view/" + url);
                return false;
            }
            
            
            var goTo = function(url) {
                if (url) {
                var iDoc = document.getElementById("viewport").contentWindow || document.getElementById("viewport").contentDocument;
                    iDoc.location.replace(url);
                }
            
                return false;
            }
            
            var onHashChange = function(event, newHash, bypass) {
                //console.log(arguments);
                document.getElementById("browserUrl").value = newHash.replace(window.location.origin, "").replace(/^\/view\//g, "");
                if (!bypass) goTo(newHash);
                else {
                    if (newHash == "about:project") {
                        goTo(window.location.origin + "/about");
                    }
                }
            };
            
    body
        // system console
        #console
        
        
        // old school browser yo
        #desktop: #browser
            #title-bar: span Webpages For Humans
            #toolbar
                #nav
                    #nav-back.btn Back
                    #nav-forward.btn Forward
                    #nav-home.btn: a(href="/about", id="aboutButton") Home
                #location
                    input(type="text", name="browserUrl", id="browserUrl")
    
            #content.container
                iframe(id="viewport", src="about:blank", style="width:960px;height:479px", frameBorder="0", onLoad="iframeChanged(this.contentWindow.location);")
    
        script(type="text/javascript")
            $("body").hashchange(onHashChange);
            $.hash.init();
            
            $("#doGenerate").on('click', doGenerate);
            $("#aboutButton").on('click', function(){ $.hash.go("about:project"); return false; });
            
            $("#browserUrl").on('keypress', function(event) {
                if (event.which == 13) {
                    //$("#doGenerate").click();
                    doGenerate();
                }
            });
            
            if (!window.location.hash) {
                $.hash.go("about:project");
            }
    
        script(type="text/javascript")
            $(function(){
                var iframe = document.getElementById("viewport");
                $("#nav-forward").click(function() {
                    window.history.forward();
                    //iframe.contentWindow.history.forward();
                });

                $("#nav-back").click(function() {
                    window.history.back();
                    //iframe.contentWindow.history.back();
                });                
                
            });


            $(function(){
                var typingInterval;
                
                var showBrowser = function() {
                    $("#console").hide();
                    $("#desktop").show();
                    window.setTimeout(function() {
                        $("#browser").show();
                    }, 3000);

                };


                typingInterval = window.setInterval(function() {
                    if (!Typer.addText()) {
                        console.log('done');
                        window.clearInterval(typingInterval);
                        window.setTimeout(showBrowser, 3000);
                    }
                }, 20);
                
            });